# Шаблоны просмотра результатов исследований

## Обзор

Созданы отдельные шаблоны для просмотра результатов лабораторных и инструментальных исследований без возможности редактирования. Эти шаблоны предназначены для врачей и медицинского персонала, которым нужно только просматривать результаты.

**Цветовые схемы соответствуют стилю `plan_detail.html`:**
- **Лабораторные исследования** - `bg-success` (зеленый)
- **Инструментальные исследования** - `bg-info` (синий)
- **Результаты** - `bg-success` (зеленый)
- **Подписи** - `bg-secondary` (серый)
- **Изображения** - `bg-warning` (желтый)

## Созданные шаблоны

### 1. `lab_test_result_view.html` - Просмотр результатов лабораторных исследований

**Назначение**: Отображение результатов анализов крови, мочи и других лабораторных исследований.

**Цветовая схема**: 
- Заголовок: `bg-success` (зеленый) - соответствует стилю лабораторных исследований в plan_detail.html
- Название исследования: `text-success` (зеленый)
- Особые указания: `alert-success` (зеленый)
- Заключение: `bg-success` (зеленый)

**Особенности**:
- Табличное представление результатов с параметрами, значениями и единицами измерения
- Цветовая индикация статуса результатов (норма, повышен, понижен, критично)
- Отображение референсных значений
- Информация о пациенте, исследовании и исполнителе
- Просмотр подписей (если есть)

**Структура данных**:
- `result.data` - словарь с параметрами исследования
- `result.conclusion` - текстовое заключение
- `signatures` - список подписей

### 2. `instrumental_result_view.html` - Просмотр результатов инструментальных исследований

**Назначение**: Отображение результатов УЗИ, рентгена, МРТ и других инструментальных процедур.

**Цветовая схема**:
- Заголовок: `bg-info` (синий) - соответствует стилю инструментальных исследований в plan_detail.html
- Название процедуры: `text-info` (синий)
- Особые указания: `alert-info` (синий)
- Заключение: `bg-info` (синий)

**Особенности**:
- Карточное представление результатов с группировкой по параметрам
- Поддержка вложенных структур данных
- Отображение изображений (если есть)
- Информация о пациенте, процедуре и исполнителе
- Просмотр подписей (если есть)

**Структура данных**:
- `result.data` - словарь с параметрами процедуры (поддерживает вложенность)
- `result.conclusion` - текстовое заключение
- `result.images` - список изображений
- `signatures` - список подписей

## URL-паттерны

### Лабораторные исследования
- `/examination/lab-tests/<pk>/result/` - просмотр результатов анализов

### Инструментальные исследования  
- `/examination/instrumental/<pk>/result/` - просмотр результатов процедур

## Представления (Views)

### `LabTestResultView`
- **Модель**: `ExaminationLabTest`
- **Шаблон**: `lab_test_result_view.html`
- **Контекст**: `lab_test`, `examination_plan`, `patient`, `encounter`, `result`, `signatures`

### `InstrumentalResultView`
- **Модель**: `ExaminationInstrumental`
- **Шаблон**: `instrumental_result_view.html`
- **Контекст**: `instrumental`, `examination_plan`, `patient`, `encounter`, `result`, `signatures`

## Интеграция с основным шаблоном

Шаблоны просмотра результатов интегрированы с `plan_detail.html`:

1. **Кнопки "Просмотреть результат"** ведут на новые шаблоны
2. **Цветовые схемы** соответствуют стилю основного шаблона
3. **Навигация** возвращает к плану обследования
4. **Стили** используют те же классы Bootstrap и FontAwesome

## Особенности реализации

### Безопасность
- Проверки на существование объектов (`{% if result and result.data %}`)
- Безопасное обращение к полям подписей
- Отсутствие кнопок редактирования

### Производительность
- Использование `select_related` для оптимизации запросов
- Загрузка связанных данных одним запросом

### Адаптивность
- Использование Bootstrap Grid для мобильной адаптации
- Responsive таблицы и карточки

## Использование

1. В плане обследования нажать кнопку "Просмотреть результат"
2. Откроется соответствующий шаблон с результатами
3. Просмотр всех данных исследования
4. Возврат к плану обследования по кнопке "Вернуться назад"

## Стилистические особенности

- **Компактные alert'ы** с `py-2 px-3` и `font-size: 0.9rem`
- **Отступы между карточками** - `mt-4`
- **Цветовая индикация** статусов результатов
- **Иконки FontAwesome** для улучшения UX
- **Единообразное оформление** с основным шаблоном 