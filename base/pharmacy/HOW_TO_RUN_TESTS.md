# Как запустить тесты сервисов Pharmacy

## Способы запуска тестов

### 1. Через Django Management Command (рекомендуется)

```bash
# Перейти в директорию base
cd web_application/base

# Активировать виртуальное окружение (если не активировано)
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# Запустить тесты
python manage.py test_pharmacy_services
```

### 2. Через bat-файл (только Windows)

```bash
# Из корневой директории проекта
cd web_application
test_pharmacy_services.bat
```

### 3. Прямой запуск Python файла (не рекомендуется)

```bash
# Перейти в директорию base
cd web_application/base

# Активировать виртуальное окружение
venv\Scripts\activate

# Запустить тест
python pharmacy/test_services.py
```

## Что тестируется

### 1. MedicationService
- Получение всех препаратов
- Поиск препаратов по названию
- Группировка по фармакологическим группам

### 2. RegimenService
- Получение схем применения для препарата
- Получение схем по диагнозу
- Отображение полной информации о схемах

### 3. PatientRecommendationService
- Подбор персонализированных рекомендаций
- Учет возраста и типа пациента
- Фильтрация по критериям

### 4. ReferenceDataService
- Получение справочных данных
- Фармакологические группы
- Формы выпуска
- Способы введения

## Ожидаемый результат

При успешном запуске вы увидите:

```
Демонстрация работы сервисов Pharmacy
==================================================

=== Тестирование MedicationService ===
Всего препаратов: 14
Пример препарата:
  Торговое название: Ампициллин (Ampicillin)
  МНН: Ампициллин
  Группа: Антибиотик группы пенициллинов...
  Форма выпуска: Порошок для приготовления...

=== Тестирование RegimenService ===
Схемы для препарата Ампициллин: 4
...

=== Тестирование PatientRecommendationService ===
Тестовый пациент: Тестовый Пациент
Возраст: 10950 дней
Пол: Мужской
Тип пациента: Взрослый
Рекомендаций найдено: 12
...

=== Тестирование ReferenceDataService ===
Фармакологических групп: 11
Форм выпуска: 13
Способов введения: 7
...

==================================================
Все тесты завершены успешно!
```

## Устранение проблем

### Ошибка "No module named 'django'"
- Убедитесь, что виртуальное окружение активировано
- Проверьте, что Django установлен: `pip install django`

### Ошибка "Cannot find path"
- Убедитесь, что вы находитесь в правильной директории
- Используйте полные пути: `cd web_application/base`

### Ошибка "FieldError"
- Проверьте, что миграции применены: `python manage.py migrate`
- Убедитесь, что данные загружены в базу

## Добавление новых тестов

Для добавления новых тестов:

1. Отредактируйте файл `pharmacy/management/commands/test_pharmacy_services.py`
2. Добавьте новый метод в класс `Command`
3. Вызовите его в методе `handle()`
4. Запустите тесты для проверки

Пример:
```python
def test_new_feature(self):
    """Тестирование новой функциональности."""
    self.stdout.write('\n=== Тестирование новой функциональности ===')
    # Ваш код тестирования
``` 